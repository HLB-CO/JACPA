<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>إضافة عميل</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap');
    @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');

    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #fff, #fff);
      color: #1a1a2e;
      direction: rtl;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px;
    }

    /* Header/Navbar Styles */
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #fff;
      padding: 2px 6px;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
      font-family: 'Poppins', sans-serif;
      position: sticky;
      top: 0;
      z-index: 1000;
      width: 100%;
      max-width: 1300px;
    }

    .logo-container img {
      height: 50px;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
    }

    .nav-link {
      text-decoration: none;
      color: #333;
      font-weight: 500;
      position: relative;
      transition: color 0.3s;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      width: 0%;
      height: 2px;
      background-color: #1a237e;
      right: 0;
      bottom: -4px;
      transition: width 0.3s;
    }

    .nav-link:hover::after {
      width: 100%;
    }

    .nav-link:hover {
      color: #1a237e;
    }

    .nav-link.active {
      color: #1a237e;
    }

    .nav-link.active::after {
      width: 100%;
    }

    .header-actions {
      display: flex;
      gap: 1rem;
      position: relative;
    }

    .header-actions button {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: #444;
      transition: color 0.2s;
    }

    .header-actions button:hover {
      color: #1a237e;
    }

    .support-dropdown {
      display: none;
      position: absolute;
      top: 120%;
      left: 0;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 0.5rem 1rem;
      width: 180px;
      z-index: 999;
    }

    .support-dropdown a {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 0;
      color: #333;
      text-decoration: none;
    }

    .support-dropdown a:hover {
      background-color: #f0f0f0;
    }

    h2 {
      font-size: 24px;
      font-weight: 400;
      color: #1a237e;
      text-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
      margin-bottom: 20px;
      text-align: center;
      margin-top: 5rem; /* ✅ تم الإضافة */
    }

    .input-group {
      width: 100%;
      max-width: 500px;
      display: flex;
      gap: 12px;
      margin-bottom: 25px;
    }

    input[type="text"] {
      flex: 1;
      padding: 12px 16px;
      font-size: 16px;
      border: 2px solid #1a237e;
      border-radius: 10px;
      outline: none;
      transition: 0.3s;
      color: #1a1a2e;
    }

    input[type="text"]:focus {
      border-color: #3949ab;
      box-shadow: 0 0 8px rgba(26, 35, 126, 0.4);
    }

    #addClientBtn {
      background: #1a237e;
      color: #fff;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      padding: 10px 20px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(26, 35, 126, 0.5);
      transition: 0.3s;
    }

    #addClientBtn:hover {
      background: #283593;
    }

    #mainContainer {
      display: flex;
      width: 100%;
      max-width: 1300px;
      height: 850px;
      gap: 20px;
    }

    #formsGrid {
      width: 250px;
      background: #fff;
      border-radius: 20px;
      padding: 15px;
      overflow-y: auto;
      box-shadow: 0 6px 20px rgba(26, 35, 126, 0.15);
    }

    .formCard {
      border-radius: 10px;
      padding: 8px;
      margin-bottom: 8px;
      text-align: center;
      cursor: pointer;
      background: #f5f7ff;
      box-shadow: 0 2px 6px rgba(26, 35, 126, 0.1);
      transition: 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .formCard:hover {
      background: #e0e7ff;
      transform: translateY(-2px);
    }

    .formCard.selected {
      background: linear-gradient(135deg, #1a237e, #3949ab);
      color: white;
      box-shadow: 0 6px 18px rgba(26, 35, 126, 0.5);
      transform: translateY(-2px);
    }

    .formCard.selected .formId,
    .formCard.selected .formTitle {
      color: white !important;
    }

    .formIcon {
      width: 26px;
      height: 40px;
      fill: #1a237e;
      transition: 0.3s;
    }

    .formCard.selected .formIcon {
      fill: white !important;
      filter: drop-shadow(0 2px 3px rgba(255,255,255,0.8));
    }

    .formId {
      font-size: 15px;
      font-weight: 700;
      color: #1a237e;
    }

    .formTitle {
      font-size: 13px;
      font-weight: 500;
      color: #444;
      line-height: 1.2;
      word-break: break-word;
    }

    iframe#formFrame {
      flex: 1;
      border: none;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(26, 35, 126, 0.2);
      background: white;
      height: 100%;
      display: none;
      transition: 0.4s;
    }

    #formsGrid::-webkit-scrollbar {
      width: 6px;
    }

    #formsGrid::-webkit-scrollbar-thumb {
      background: #1a237e88;
      border-radius: 6px;
    }

    #changeClientBtn {
      margin-top: 15px;
      background: #d32f2f;
      color: white;
      border: none;
      border-radius: 10px;
      padding: 10px 18px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(211, 47, 47, 0.5);
      display: none;
      align-self: flex-start;
      transition: 0.3s;
    }

    #changeClientBtn:hover {
      background: #b71c1c;
    }
  </style>
</head>
<body>
  <!-- Header/Navbar -->
  <header class="dashboard-header">
    <div class="logo-container">
      <img src="https://res.cloudinary.com/dvrjapxpd/image/upload/v1753147012/M__2_-removebg-preview_wuisdm.png" alt="Logo" />
    </div>

    <nav class="nav-links">
      <a href="addclient.html" class="nav-link" id="addClientLink">Add Client</a>
      <a href="clientlist.html" class="nav-link active" id="clientListLink">Client List</a>
    </nav>

    <div class="header-actions">
      <span id="user-info" style="font-weight: bold;"></span>

      <button onclick="logout()" style="background-color: #c00; border: none; color: white; padding: 6px 12px; border-radius: 6px; cursor: pointer;">تسجيل الخروج</button>

      <button id="settingsBtn"><i class="fas fa-cog"></i></button>

      <div class="support-dropdown" id="supportDropdown">
        <a href="https://api.whatsapp.com/send/?phone=962788677607&text&type=phone_number&app_absent=0" target="_blank">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </a>
        <a href="mailto:abdulhadi.sa00@gmail.com">
          <i class="fas fa-envelope"></i> Email
        </a>
      </div>
    </div>
  </header>

  <h2>Enter Client Name to View Forms</h2>

  <div class="input-group" id="inputGroup">
    <input type="text" id="clientName" placeholder="Client Name" autocomplete="off" />
    <button id="addClientBtn" onclick="showForms()">Add Client</button>
  </div>

  <div id="mainContainer">
    <div id="formsGrid"></div>

    <div style="flex-grow:1; display:flex; flex-direction: column; gap: 10px;">
      <div id="selectedClientName" style="
        font-weight: 700; 
        font-size: 20px; 
        color: #2233ff; 
        min-height: 28px; 
        user-select: none;
        padding-bottom: 8px;
        border-bottom: 2px solid #2233ff;
        display: none;
      "></div>

      <button id="changeClientBtn" onclick="changeClient()">Change Client</button>

      <iframe id="formFrame" src="" frameborder="0"></iframe>
    </div>
  </div>

  <script>
    const formSVGIcon = `
      <svg class="formIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" >
        <path d="M6 2h9l5 5v15a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1zM15 3.5V8h4.5L15 3.5zM8 11h8v2H8v-2zm0 4h8v2H8v-2z"/>
      </svg>
    `;

    const forms = [
      { formId: "A.1", url: "https://tally.so/r/nWgYee", title: "نموذج قبول عميل جديد / استمرار" },
      { formId: "A.2", url: "https://tally.so/r/3x6VZd", title: "نموذج تثبيت الاستقلالية" },
      { formId: "A.3", url: "https://tally.so/r/wAQr8y", title: "كتاب التعيين" },
      { formId: "A.4", url: "https://tally.so/r/wMG15l", title: "نبذة عن العميل ونشاطه" },
      { formId: "A.5", url: "https://tally.so/r/wox9ZM", title: "مذكرة تخطيط التدقيق" },
      { formId: "A.6", url: "https://tally.so/r/w8ENWA", title: "الأهمية النسبية" },
      { formId: "A.7", url: "https://tally.so/r/wgOLJd", title: "فحص إجراءات الرقابة" },
      { formId: "A.8", url: "https://tally.so/r/3y7xAd", title: "كتاب الملاحظات على الضبط الداخلي" },
      { formId: "B.1", url: "https://tally.so/r/wdRlGV", title: "نموذج كتاب النواقص" },
      { formId: "B.2", url: "https://tally.so/r/mYqrBv", title: "البيانات المالية النهائية" },
      { formId: "B.3", url: "https://tally.so/r/mDW5OE", title: "مسودة البيانات المالية" },
      { formId: "B.4", url: "https://tally.so/r/3l4L2X", title: "مسودة البيانات المالية المربطة" },
      { formId: "B.5", url: "https://tally.so/r/mRrReQ", title: "تربيط ميزان المراجعة" },
      { formId: "B.6", url: "https://tally.so/r/woxoNN", title: "ميزان المراجعة النهائي" },
      { formId: "B.7", url: "https://tally.so/r/3qNO8O", title: "محاضر اجتماعات مجلس الإدارة" },
      { formId: "B.8", url: "https://tally.so/r/n0ALq9", title: "ملخص القضايا وكتاب المستشار القانوني" },
      { formId: "B.9", url: "https://tally.so/r/3l4L8o", title: "الوضع الضريبي وكشف الضريبة" },
      { formId: "B.10", url: "https://tally.so/r/wal0MX", title: "نموذج الأحداث اللاحقة" },
      { formId: "B.11", url: "https://tally.so/r/meoLJl", title: "نموذج الاستمرارية" },
      { formId: "B.12", url: "https://tally.so/r/wvW4kD", title: "كتاب التمثيل" },
      { formId: "B.13", url: "https://tally.so/r/wgOL24", title: "نموذج الإفصاحات للمعايير" },
      { formId: "B.14", url: "https://tally.so/r/nrqV7R", title: "نموذج المعاملات مع الأطراف" },
      { formId: "B.15", url: "https://tally.so/r/wal07B", title: "كتاب ومتطلبات الإقفال" },
      { formId: "B.16", url: "https://tally.so/r/mVxV2g", title: "تحديث ملف التدقيق الدائم" },
      { formId: "C.1", url: "https://tally.so/r/w4GN1B", title: "قائمة المركز المالي" },
      { formId: "C.2", url: "https://tally.so/r/3qNEYd", title: "قائمة الدخل الشامل" },
      { formId: "C.10", url: "https://tally.so/r/wQEBxA", title: "النقد وما في حكمه" },
      { formId: "C.20", url: "https://tally.so/r/3y7q0p", title: "الذمم التجارية المدينة" },
      { formId: "C.30", url: "https://tally.so/r/w8EpJY", title: "الاستثمارات" },
      { formId: "C.40", url: "https://tally.so/r/w5OqlP", title: "المخزون" },
      { formId: "C.50", url: "https://tally.so/r/wdR2Zy", title: "أرصدة مدينة أخرى" },
      { formId: "C.60", url: "https://tally.so/r/mYqzo6", title: "الممتلكات والآلات والمعدات" },
      { formId: "C.70", url: "https://tally.so/r/mZQRPa", title: "الأعباء المؤجلة والموجودات غير الملموسة" },
      { formId: "C.80", url: "https://tally.so/r/3y700B", title: "الموجودات الأخرى غير المتداولة" },
      { formId: "C.90", url: "https://tally.so/r/n0AbbN", title: "نموذج الأطراف ذات العلاقة" },
      { formId: "C.100", url: "https://tally.so/r/3l40VB", title: "الديون المتداولة" },
      { formId: "C.110", url: "https://tally.so/r/mRrZ8d", title: "الذمم التجارية الدائنة" },
      { formId: "C.120", url: "https://tally.so/r/wox0le", title: "أرصدة دائنة أخرى" },
      { formId: "C.130", url: "https://tally.so/r/wgOKdY", title: "الاحتياطات والأعباء المستحقة" },
      { formId: "C.140", url: "https://tally.so/r/n0ALAb", title: "الالتزامات طويلة الأجل" },
      { formId: "C.150", url: "https://tally.so/r/wvWQdw", title: "رأس المال والاحتياطات" },
      { formId: "C.160", url: "https://tally.so/r/3qNPNx", title: "قائمة التدفقات النقدية" }
    ];

    let selectedFormIndex = null;

    const formsGrid = document.getElementById("formsGrid");
    const formFrame = document.getElementById("formFrame");
    const selectedClientNameDiv = document.getElementById("selectedClientName");
    const inputGroup = document.getElementById("inputGroup");
    const clientNameInput = document.getElementById("clientName");
    const changeClientBtn = document.getElementById("changeClientBtn");

    // إنشاء بطاقات النماذج داخل ال sidebar
    function createFormCards() {
      formsGrid.innerHTML = "";
      forms.forEach((form, index) => {
        const card = document.createElement("div");
        card.className = "formCard";
        card.dataset.index = index;
        card.innerHTML = `
          ${formSVGIcon}
          <span class="formId">${form.formId}</span>
          <span class="formTitle">${form.title}</span>
        `;
        card.addEventListener("click", () => {
          selectForm(index);
        });
        formsGrid.appendChild(card);
      });
    }

    // تحديد نموذج معين وفتحه في iframe
    function selectForm(index) {
      if (selectedFormIndex !== null) {
        // إزالة تحديد من النموذج القديم
        const oldCard = formsGrid.querySelector(`.formCard[data-index="${selectedFormIndex}"]`);
        if (oldCard) oldCard.classList.remove("selected");
      }
      selectedFormIndex = index;
      const newCard = formsGrid.querySelector(`.formCard[data-index="${index}"]`);
      if (newCard) newCard.classList.add("selected");

      const url = forms[index].url + `?client=${encodeURIComponent(clientNameInput.value.trim())}`;
      formFrame.src = url;
      formFrame.style.display = "block";
    }

    // عرض النماذج عند الضغط على زر "Add Client"
    function showForms() {
      const clientName = clientNameInput.value.trim();
      if (!clientName) {
        alert("يرجى إدخال اسم العميل");
        return;
      }

      inputGroup.style.display = "none";
      formsGrid.style.display = "block";
      selectedClientNameDiv.style.display = "block";
      selectedClientNameDiv.textContent = `العميل: ${clientName}`;
      changeClientBtn.style.display = "inline-block";

      createFormCards();
      formFrame.style.display = "none"; // لا نعرض الإطار حتى يختار المستخدم نموذج
    }

    // تغيير العميل للعودة إلى شاشة الإدخال
    function changeClient() {
      clientNameInput.value = "";
      inputGroup.style.display = "flex";
      formsGrid.style.display = "none";
      formFrame.style.display = "none";
      selectedClientNameDiv.style.display = "none";
      changeClientBtn.style.display = "none";
      selectedFormIndex = null;
    }

    // تسجيل الخروج - ضع هنا منطق تسجيل الخروج الخاص بك
    function logout() {
      alert("تم تسجيل الخروج!");
      // مثال: إعادة التوجيه لصفحة تسجيل الدخول
      // window.location.href = "login.html";
    }

    // إبراز الرابط النشط في الهيدر
    function highlightActiveLink() {
      const current = window.location.pathname.split("/").pop();
      const addClientLink = document.getElementById("addClientLink");
      const clientListLink = document.getElementById("clientListLink");

      if (current === "addclient.html") {
        addClientLink.classList.add("active");
        clientListLink.classList.remove("active");
      } else if (current === "clientlist.html") {
        clientListLink.classList.add("active");
        addClientLink.classList.remove("active");
      }
    }

    // دعم قائمة الدعم (WhatsApp & Email)
    const settingsBtn = document.getElementById("settingsBtn");
    const supportDropdown = document.getElementById("supportDropdown");
    settingsBtn.addEventListener("click", () => {
      if (supportDropdown.style.display === "block") {
        supportDropdown.style.display = "none";
      } else {
        supportDropdown.style.display = "block";
      }
    });

    // إخفاء قائمة الدعم عند النقر في أي مكان خارجها
    document.addEventListener("click", (e) => {
      if (!settingsBtn.contains(e.target) && !supportDropdown.contains(e.target)) {
        supportDropdown.style.display = "none";
      }
    });

    // تعيين اسم المستخدم (مثال)
    function setUserInfo() {
      const userInfoSpan = document.getElementById("user-info");
      // هنا يمكنك جلب اسم المستخدم فعلياً من التخزين المحلي أو API
      userInfoSpan.textContent = "MSINDAHA"; // مثال اسم المستخدم
    }

    // تهيئة الصفحة
    function init() {
      highlightActiveLink();
      setUserInfo();
      changeClient(); // إظهار شاشة الإدخال كبداية
    }

    window.onload = init;
  </script>
</body>
</html>
